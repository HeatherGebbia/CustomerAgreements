@page
@model IndexModel
@{
    ViewData["Title"] = "Customer Agreements";
}



<div class="jumbotron p-3">
    <form class="form-group">
        <div class="alert alert-info d-flex align-items-start mt-3" role="alert">
            <div>
                <h5 class="alert-heading mb-1">Demo Application</h5>
                <p class="mb-0">
                    This is a demo version of the Customer Agreement application.
                    All data shown is sample data.
                    To experience the customer workflow, click
                    <strong>"Start Demo: Create a New Agreement"</strong> below to create and submit a sample agreement.
                </p>
            </div>
        </div>
        <div>
            <a class="btn btn-primary btn-sm" asp-page="/Agreement/Create" asp-route-questionnaireId="@Model.Questionnaire.QuestionnaireID">
                Start Demo: Create a New Agreement
            </a>
        </div>
        <br />
        <label asp-for="SelectedCompanyName" class="control-label">
            Companies:
        </label>
        <select class="p-2" asp-for="SelectedCompanyName" asp-items="Model.CompanyNames" onchange="this.form.submit();">
            <option value="">All</option>
        </select>

        <label asp-for="SearchString" class="control-label">
            Name:
        </label>
        <input class="p-2" type="text" asp-for="SearchString" />
        <input type="submit" value="Search" class="btn btn-primary btn-sm" />
        <label asp-for="SortField" class="control-label">
            Sort by:
        </label>
        <select class="p-2" asp-for="SortField" onchange="this.form.submit();">
            <option value="ContactName">
                Contact Name
            </option>
            <option value="CompanyName">
                Company Name
            </option>
        </select>
    </form>
</div>

@if (Model.Agreements.Count == 0)
{
    <p><em>No customers found.</em></p>
}
else
{    
    <table class="table table-striped">
        <thead>
            <tr>
                <th>Company Name</th>
                <th>Contact Name</th>                
                <th>Email Address</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var a in Model.Agreements)
            {
                <tr>
                    <td>
                        <a asp-page="/Agreement/Detail"
                           asp-route-questionnaireId="@a.QuestionnaireID"
                           asp-route-agreementId="@a.AgreementID">
                            @a.Customer?.CompanyName
                        </a>
                    </td>
                    <td>@a.Customer?.ContactName</td>
                    <td>@a.Customer?.EmailAddress</td>
                </tr>
            }
        </tbody>
    </table>
    
}